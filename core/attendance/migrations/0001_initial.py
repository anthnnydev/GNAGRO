# Generated by Django 5.2.1 on 2025-06-06 14:46

import datetime
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('employees', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AttendanceRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nombre de la Regla')),
                ('late_threshold', models.IntegerField(default=15, verbose_name='Umbral de Tardanza (minutos)')),
                ('overtime_threshold', models.DecimalField(decimal_places=2, default=8.0, max_digits=4, verbose_name='Umbral de Horas Extras (horas)')),
                ('overtime_multiplier', models.DecimalField(decimal_places=2, default=1.5, max_digits=3, verbose_name='Multiplicador de Horas Extras')),
                ('max_consecutive_absences', models.IntegerField(default=3, verbose_name='Máximo de Ausencias Consecutivas')),
                ('require_justification', models.BooleanField(default=True, verbose_name='Requiere Justificación')),
                ('is_active', models.BooleanField(default=True, verbose_name='Activo')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Regla de Asistencia',
                'verbose_name_plural': 'Reglas de Asistencia',
                'db_table': 'attendance_rule',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='WorkSchedule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nombre del Horario')),
                ('schedule_type', models.CharField(choices=[('fixed', 'Horario Fijo'), ('flexible', 'Horario Flexible'), ('shift', 'Por Turnos'), ('remote', 'Trabajo Remoto')], default='fixed', max_length=15, verbose_name='Tipo de Horario')),
                ('start_time', models.TimeField(verbose_name='Hora de Inicio')),
                ('end_time', models.TimeField(verbose_name='Hora de Fin')),
                ('break_duration', models.DurationField(default=datetime.timedelta(seconds=3600), verbose_name='Duración del Descanso')),
                ('weekly_hours', models.DecimalField(decimal_places=2, default=40.0, max_digits=4, verbose_name='Horas Semanales')),
                ('late_tolerance', models.IntegerField(default=15, verbose_name='Tolerancia de Tardanza (minutos)')),
                ('monday', models.BooleanField(default=True, verbose_name='Lunes')),
                ('tuesday', models.BooleanField(default=True, verbose_name='Martes')),
                ('wednesday', models.BooleanField(default=True, verbose_name='Miércoles')),
                ('thursday', models.BooleanField(default=True, verbose_name='Jueves')),
                ('friday', models.BooleanField(default=True, verbose_name='Viernes')),
                ('saturday', models.BooleanField(default=False, verbose_name='Sábado')),
                ('sunday', models.BooleanField(default=False, verbose_name='Domingo')),
                ('is_active', models.BooleanField(default=True, verbose_name='Activo')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Horario de Trabajo',
                'verbose_name_plural': 'Horarios de Trabajo',
                'db_table': 'attendance_schedule',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Attendance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(verbose_name='Fecha')),
                ('clock_in', models.TimeField(blank=True, null=True, verbose_name='Hora de Entrada')),
                ('clock_out', models.TimeField(blank=True, null=True, verbose_name='Hora de Salida')),
                ('break_start', models.TimeField(blank=True, null=True, verbose_name='Inicio de Descanso')),
                ('break_end', models.TimeField(blank=True, null=True, verbose_name='Fin de Descanso')),
                ('total_hours', models.DecimalField(decimal_places=2, default=0.0, max_digits=4, verbose_name='Horas Totales')),
                ('regular_hours', models.DecimalField(decimal_places=2, default=0.0, max_digits=4, verbose_name='Horas Regulares')),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=0.0, max_digits=4, verbose_name='Horas Extras')),
                ('break_duration', models.DurationField(default=datetime.timedelta(0), verbose_name='Duración del Descanso')),
                ('status', models.CharField(choices=[('present', 'Presente'), ('absent', 'Ausente'), ('late', 'Tardanza'), ('partial', 'Parcial'), ('holiday', 'Feriado'), ('vacation', 'Vacaciones'), ('sick', 'Enfermedad'), ('remote', 'Trabajo Remoto')], default='present', max_length=15, verbose_name='Estado')),
                ('is_late', models.BooleanField(default=False, verbose_name='Llegó Tarde')),
                ('late_minutes', models.IntegerField(default=0, verbose_name='Minutos de Tardanza')),
                ('early_departure', models.BooleanField(default=False, verbose_name='Salida Temprana')),
                ('early_departure_minutes', models.IntegerField(default=0, verbose_name='Minutos de Salida Temprana')),
                ('clock_in_location', models.CharField(blank=True, max_length=200, verbose_name='Ubicación de Entrada')),
                ('clock_out_location', models.CharField(blank=True, max_length=200, verbose_name='Ubicación de Salida')),
                ('clock_in_ip', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP de Entrada')),
                ('clock_out_ip', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP de Salida')),
                ('is_justified', models.BooleanField(default=False, verbose_name='Justificado')),
                ('justification', models.TextField(blank=True, verbose_name='Justificación')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Aprobación')),
                ('notes', models.TextField(blank=True, verbose_name='Notas')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_attendance', to='employees.employee', verbose_name='Aprobado por')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendance_records', to='employees.employee', verbose_name='Empleado')),
                ('schedule', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='attendance.workschedule', verbose_name='Horario Asignado')),
            ],
            options={
                'verbose_name': 'Registro de Asistencia',
                'verbose_name_plural': 'Registros de Asistencia',
                'db_table': 'attendance_attendance',
                'ordering': ['-date', '-clock_in'],
            },
        ),
        migrations.CreateModel(
            name='AttendanceCorrection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('correction_type', models.CharField(choices=[('clock_in', 'Corrección de Entrada'), ('clock_out', 'Corrección de Salida'), ('break', 'Corrección de Descanso'), ('status', 'Corrección de Estado'), ('hours', 'Corrección de Horas')], max_length=15, verbose_name='Tipo de Corrección')),
                ('reason', models.TextField(verbose_name='Motivo de la Corrección')),
                ('original_clock_in', models.TimeField(blank=True, null=True)),
                ('original_clock_out', models.TimeField(blank=True, null=True)),
                ('original_status', models.CharField(blank=True, max_length=15)),
                ('corrected_clock_in', models.TimeField(blank=True, null=True)),
                ('corrected_clock_out', models.TimeField(blank=True, null=True)),
                ('corrected_status', models.CharField(blank=True, max_length=15)),
                ('status', models.CharField(choices=[('pending', 'Pendiente'), ('approved', 'Aprobada'), ('rejected', 'Rechazada')], default='pending', max_length=15, verbose_name='Estado')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Aprobación')),
                ('rejection_reason', models.TextField(blank=True, verbose_name='Motivo de Rechazo')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_corrections', to='employees.employee', verbose_name='Aprobado por')),
                ('attendance', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='corrections', to='attendance.attendance', verbose_name='Registro de Asistencia')),
                ('requested_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendance_corrections', to='employees.employee', verbose_name='Solicitado por')),
            ],
            options={
                'verbose_name': 'Corrección de Asistencia',
                'verbose_name_plural': 'Correcciones de Asistencia',
                'db_table': 'attendance_correction',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Holiday',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nombre del Feriado')),
                ('date', models.DateField(verbose_name='Fecha')),
                ('is_recurring', models.BooleanField(default=False, verbose_name='Se Repite Anualmente')),
                ('is_paid', models.BooleanField(default=True, verbose_name='Es Remunerado')),
                ('description', models.TextField(blank=True, verbose_name='Descripción')),
                ('is_active', models.BooleanField(default=True, verbose_name='Activo')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Feriado',
                'verbose_name_plural': 'Feriados',
                'db_table': 'attendance_holiday',
                'ordering': ['date'],
                'unique_together': {('name', 'date')},
            },
        ),
        migrations.CreateModel(
            name='EmployeeSchedule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('start_date', models.DateField(verbose_name='Fecha de Inicio')),
                ('end_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Fin')),
                ('is_active', models.BooleanField(default=True, verbose_name='Activo')),
                ('notes', models.TextField(blank=True, verbose_name='Notas')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='schedules', to='employees.employee', verbose_name='Empleado')),
                ('schedule', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='employee_assignments', to='attendance.workschedule', verbose_name='Horario')),
            ],
            options={
                'verbose_name': 'Horario de Empleado',
                'verbose_name_plural': 'Horarios de Empleados',
                'db_table': 'attendance_employee_schedule',
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='AttendanceSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('year', models.IntegerField(verbose_name='Año')),
                ('month', models.IntegerField(verbose_name='Mes')),
                ('total_work_days', models.IntegerField(default=0, verbose_name='Días Laborales')),
                ('days_present', models.IntegerField(default=0, verbose_name='Días Presente')),
                ('days_absent', models.IntegerField(default=0, verbose_name='Días Ausente')),
                ('days_late', models.IntegerField(default=0, verbose_name='Días con Tardanza')),
                ('days_partial', models.IntegerField(default=0, verbose_name='Días Parciales')),
                ('total_hours', models.DecimalField(decimal_places=2, default=0.0, max_digits=6, verbose_name='Horas Totales')),
                ('regular_hours', models.DecimalField(decimal_places=2, default=0.0, max_digits=6, verbose_name='Horas Regulares')),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=0.0, max_digits=6, verbose_name='Horas Extras')),
                ('total_late_minutes', models.IntegerField(default=0, verbose_name='Total Minutos de Tardanza')),
                ('attendance_percentage', models.DecimalField(decimal_places=2, default=0.0, max_digits=5, verbose_name='Porcentaje de Asistencia')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendance_summaries', to='employees.employee', verbose_name='Empleado')),
            ],
            options={
                'verbose_name': 'Resumen de Asistencia',
                'verbose_name_plural': 'Resúmenes de Asistencia',
                'db_table': 'attendance_summary',
                'ordering': ['-year', '-month', 'employee__employee_number'],
                'unique_together': {('employee', 'year', 'month')},
            },
        ),
        migrations.AddIndex(
            model_name='attendance',
            index=models.Index(fields=['employee', 'date'], name='attendance__employe_08d913_idx'),
        ),
        migrations.AddIndex(
            model_name='attendance',
            index=models.Index(fields=['date', 'status'], name='attendance__date_3889e6_idx'),
        ),
        migrations.AddIndex(
            model_name='attendance',
            index=models.Index(fields=['created_at'], name='attendance__created_a6132d_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='attendance',
            unique_together={('employee', 'date')},
        ),
    ]
